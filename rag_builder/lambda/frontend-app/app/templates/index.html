<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js"
      integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz"
      crossorigin="anonymous"
    ></script>
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
      }
      body {
        display: flex;
        flex-direction: column;
      }
      main {
        flex: 1 0 auto;
      }
      header,
      footer {
        flex-shrink: 0;
      }
      .htmx-indicator-button .htmx-indicator {
        display: none;
      }
      .htmx-indicator-button.htmx-request-inprogress .htmx-indicator {
        display: inline-block;
      }
      .htmx-indicator-button.htmx-request-inprogress .htmx-indicator-text {
        display: none;
      }
      .btn-danger {
        --pico-primary: #d32f2f;
        --pico-primary-hover: #b71c1c;
        --pico-primary-focus: rgba(211, 47, 47, 0.25);
      }
      aside {
        background-color: var(--pico-secondary-background);
        padding: var(--pico-spacing);
        border-radius: var(--pico-border-radius);
      }
      .sidebar-header {
        font-size: 1.1em;
        font-weight: bold;
        margin-bottom: 0.5rem;
      }
      .hero {
        text-align: center;
        padding: 3rem 0;
      }
    </style>
  </head>
  <body>
    <header class="container">
      <nav>
        <ul>
          <li><strong>üìö RAG Builder</strong></li>
        </ul>
        <ul>
          <li>
            <details role="list" class="dropdown">
              <summary aria-haspopup="listbox" role="button">üßë</summary>
              <ul role="listbox">
                <li><small>Hi, {{ user }}!</small></li>
                <li>
                  <a href="/auth/logout">Logout</a>
                </li>
              </ul>
            </details>
          </li>
        </ul>
      </nav>
    </header>
    <main class="container">
      <div class="grid" style="grid-template-columns: 1fr 3fr;">
        <aside>
          <nav>
            <ul>
              <li>
                <div class="sidebar-header">üìö Knowledge Base</div>
                <ul>
                  <li>
                    <a
                      href="#"
                      hx-get="/frontend/knowledge-base/available-documents"
                      hx-target="#content"
                      >üìÑ Available Documents</a
                    >
                  </li>
                  <li>
                    <a
                      href="#"
                      hx-get="/frontend/knowledge-base/query"
                      hx-target="#content"
                      >‚ùì Query</a
                    >
                  </li>
                </ul>
              </li>
              <li>
                <div class="sidebar-header">üì• Load Document</div>
                <ul>
                  <li>
                    <a
                      href="#"
                      hx-get="/frontend/load-document/new-document"
                      hx-target="#content"
                      >‚ûï New Document</a
                    >
                  </li>
                  <li>
                    <a
                      href="#"
                      hx-get="/frontend/load-document/load-history"
                      hx-target="#content"
                      >üìú Load History</a
                    >
                  </li>
                </ul>
              </li>
            </ul>
          </nav>
        </aside>
        <section id="content">
          <dialog id="instructions-modal">
            <article>
              <header>
                <button
                  class="close"
                  data-target="instructions-modal"
                  onClick="toggleModal(event)"
                ></button>
                Instructions
              </header>
              <p>
                Welcome to RAG Builder! This application allows you to create and
                manage a knowledge base for a RAG (Retrieval-Augmented
                Generation) system.
              </p>
              <p>
                Use the sidebar to navigate through the different sections:
              </p>
              <ul>
                <li>
                  <b>Knowledge Base:</b> View available documents and query the
                  knowledge base.
                </li>
                <li>
                  <b>Load Document:</b> Load new documents into the knowledge
                  base and view the history of loaded documents.
                </li>
              </ul>
            </article>
          </dialog>
          <div class="hero">
            <hgroup>
              <h1>Welcome to RAG Builder!</h1>
              <h2>Your personal knowledge base builder.</h2>
            </hgroup>
            <p>
              Use the sidebar to load new documents, query your knowledge base, and
              more.
            </p>
            <button
              data-target="instructions-modal"
              onClick="toggleModal(event)"
            >
              Instructions
            </button>
          </div>
        </section>
      </div>
    </main>
    <footer class="container" style="text-align: center;">
      <small
        >Created by <a href="https://github.com/gontzalm">gontzalm</a> | Source
        code in
        <a href="https://github.com/gontzalm/rag-builder">GitHub</a> | Powered by
        Pico ‚ú®</small
      >
    </footer>
    <dialog id="delete-modal">
      <article>
        <header>
          <button
            class="close"
          data-target="delete-modal"
            onClick="toggleModal(event)"
          ></button>
          Delete Document
        </header>
        <p>Are you sure you want to delete this document?</p>
        <footer>
          <button
            class="secondary"
            data-target="delete-modal"
            onClick="toggleModal(event)"
          >
            Cancel
          </button>
          <button
            id="delete-confirm-button"
            hx-target="#content"
            onClick="toggleModal(event)"
          >
            Confirm
          </button>
        </footer>
      </article>
    </dialog>

    <script>
      const toggleModal = (event) => {
        const modal = document.getElementById(
          event.currentTarget.dataset.target
        );
        if (modal) {
          modal.open ? modal.close() : modal.showModal();
        }
      };

      document.body.addEventListener("htmx:configRequest", (event) => {
        if (event.detail.path.includes("/delete")) {
          event.detail.headers["hx-confirm"] = false;
        }
      });

      document.body.addEventListener("click", (event) => {
        if (event.target.dataset.deleteUrl) {
          const deleteUrl = event.target.dataset.deleteUrl;
          const confirmButton = document.getElementById("delete-confirm-button");
          confirmButton.setAttribute("hx-delete", deleteUrl);
          toggleModal({ currentTarget: { dataset: { target: "delete-modal" } } });
        }
      });
    </script>
  </body>
</html>

